{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cesarhugo.barzano/Desktop/CesarCorp/coins/serum-dex-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/cesarhugo.barzano/Desktop/CesarCorp/coins/serum-dex-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/cesarhugo.barzano/Desktop/CesarCorp/coins/serum-dex-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/cesarhugo.barzano/Desktop/CesarCorp/coins/serum-dex-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/cesarhugo.barzano/Desktop/CesarCorp/coins/serum-dex-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/cesarhugo.barzano/Desktop/CesarCorp/coins/serum-dex-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/cesarhugo.barzano/Desktop/CesarCorp/coins/serum-dex-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import EventEmitter from'eventemitter3';import{notify}from'../../utils/notifications';import{DEFAULT_PUBLIC_KEY}from'../types';export var SolflareExtensionWalletAdapter=/*#__PURE__*/function(_EventEmitter){_inherits(SolflareExtensionWalletAdapter,_EventEmitter);var _super=_createSuper(SolflareExtensionWalletAdapter);function SolflareExtensionWalletAdapter(){var _this;_classCallCheck(this,SolflareExtensionWalletAdapter);_this=_super.call(this);_this._handleConnect=function(){var _this2;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}(_this2=_this).emit.apply(_this2,['connect'].concat(args));};_this._handleDisconnect=function(){var _this$_provider,_this$_provider2,_this3;(_this$_provider=_this._provider)===null||_this$_provider===void 0?void 0:_this$_provider.off('connect',_this._handleConnect);(_this$_provider2=_this._provider)===null||_this$_provider2===void 0?void 0:_this$_provider2.off('disconnect',_this._handleDisconnect);for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2];}(_this3=_this).emit.apply(_this3,['disconnect'].concat(args));};_this.connect=_this.connect.bind(_assertThisInitialized(_this));return _this;}_createClass(SolflareExtensionWalletAdapter,[{key:\"_provider\",get:function get(){var _window,_window$solflare;if((_window=window)===null||_window===void 0?void 0:(_window$solflare=_window.solflare)===null||_window$solflare===void 0?void 0:_window$solflare.isSolflare){return window.solflare;}return undefined;}},{key:\"connected\",get:function get(){var _this$_provider3;return((_this$_provider3=this._provider)===null||_this$_provider3===void 0?void 0:_this$_provider3.isConnected)||false;}},{key:\"autoApprove\",get:function get(){var _this$_provider4;return((_this$_provider4=this._provider)===null||_this$_provider4===void 0?void 0:_this$_provider4.autoApprove)||false;}},{key:\"signAllTransactions\",value:function(){var _signAllTransactions=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(transactions){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(this._provider){_context.next=2;break;}return _context.abrupt(\"return\",transactions);case 2:return _context.abrupt(\"return\",this._provider.signAllTransactions(transactions));case 3:case\"end\":return _context.stop();}}},_callee,this);}));function signAllTransactions(_x){return _signAllTransactions.apply(this,arguments);}return signAllTransactions;}()},{key:\"publicKey\",get:function get(){var _this$_provider5;return((_this$_provider5=this._provider)===null||_this$_provider5===void 0?void 0:_this$_provider5.publicKey)||DEFAULT_PUBLIC_KEY;}},{key:\"signTransaction\",value:function(){var _signTransaction=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(transaction){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(this._provider){_context2.next=2;break;}return _context2.abrupt(\"return\",transaction);case 2:return _context2.abrupt(\"return\",this._provider.signTransaction(transaction));case 3:case\"end\":return _context2.stop();}}},_callee2,this);}));function signTransaction(_x2){return _signTransaction.apply(this,arguments);}return signTransaction;}()},{key:\"connect\",value:function(){var _connect=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _this$_provider6,_this$_provider7,_this$_provider8;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(this._provider){_context3.next=4;break;}window.open('https://solflare.com/','_blank');notify({message:'Connection Error',description:'Please install Solflare extension'});return _context3.abrupt(\"return\");case 4:(_this$_provider6=this._provider)===null||_this$_provider6===void 0?void 0:_this$_provider6.on('connect',this._handleConnect);(_this$_provider7=this._provider)===null||_this$_provider7===void 0?void 0:_this$_provider7.on('disconnect',this._handleDisconnect);return _context3.abrupt(\"return\",(_this$_provider8=this._provider)===null||_this$_provider8===void 0?void 0:_this$_provider8.connect());case 7:case\"end\":return _context3.stop();}}},_callee3,this);}));function connect(){return _connect.apply(this,arguments);}return connect;}()},{key:\"disconnect\",value:function(){var _disconnect=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(this._provider){this._provider.disconnect();}case 1:case\"end\":return _context4.stop();}}},_callee4,this);}));function disconnect(){return _disconnect.apply(this,arguments);}return disconnect;}()}]);return SolflareExtensionWalletAdapter;}(EventEmitter);","map":{"version":3,"sources":["/Users/cesarhugo.barzano/Desktop/CesarCorp/coins/serum-dex-ui/src/wallet-adapters/solflare-extension/index.tsx"],"names":["EventEmitter","notify","DEFAULT_PUBLIC_KEY","SolflareExtensionWalletAdapter","_handleConnect","args","emit","_handleDisconnect","_provider","off","connect","bind","window","solflare","isSolflare","undefined","isConnected","autoApprove","transactions","signAllTransactions","publicKey","transaction","signTransaction","open","message","description","on","disconnect"],"mappings":"yuCAAA,MAAOA,CAAAA,YAAP,KAAyB,eAAzB,CAEA,OAASC,MAAT,KAAuB,2BAAvB,CACA,OAASC,kBAAT,KAAkD,UAAlD,CAsBA,UAAaC,CAAAA,8BAAb,sJAGE,yCAAc,gEACZ,wBADY,MAYNC,cAZM,CAYW,UAAa,0CAATC,IAAS,0CAATA,IAAS,wBACpC,eAAKC,IAAL,eAAU,SAAV,SAAwBD,IAAxB,GACD,CAda,OAgBNE,iBAhBM,CAgBc,UAAa,6CACvC,uBAAKC,SAAL,0DAAgBC,GAAhB,CAAoB,SAApB,CAA+B,MAAKL,cAApC,EACA,wBAAKI,SAAL,4DAAgBC,GAAhB,CAAoB,YAApB,CAAkC,MAAKF,iBAAvC,EAFuC,+BAATF,IAAS,+CAATA,IAAS,0BAGvC,eAAKC,IAAL,eAAU,YAAV,SAA2BD,IAA3B,GACD,CApBa,CAEZ,MAAKK,OAAL,CAAe,MAAKA,OAAL,CAAaC,IAAb,+BAAf,CAFY,aAGb,CANH,kEAQE,cAA+D,8BAC7D,YAAKC,MAAL,oDAAI,QAAiBC,QAArB,2CAAI,iBAA2BC,UAA/B,CAA2C,CACzC,MAAQF,CAAAA,MAAD,CAAgBC,QAAvB,CACD,CACD,MAAOE,CAAAA,SAAP,CACD,CAbH,uBAyBE,cAAgB,sBACd,MAAO,wBAAKP,SAAL,4DAAgBQ,WAAhB,GAA+B,KAAtC,CACD,CA3BH,yBA6BE,cAAkB,sBAChB,MAAO,wBAAKR,SAAL,4DAAgBS,WAAhB,GAA+B,KAAtC,CACD,CA/BH,+HAiCE,iBACEC,YADF,qHAGO,KAAKV,SAHZ,yDAIWU,YAJX,yCAOS,KAAKV,SAAL,CAAeW,mBAAf,CAAmCD,YAAnC,CAPT,6DAjCF,4IA2CE,cAAgB,sBACd,MAAO,wBAAKV,SAAL,4DAAgBY,SAAhB,GAA6BlB,kBAApC,CACD,CA7CH,uHA+CE,kBAAsBmB,WAAtB,yHACO,KAAKb,SADZ,2DAEWa,WAFX,0CAKS,KAAKb,SAAL,CAAec,eAAf,CAA+BD,WAA/B,CALT,+DA/CF,iNAuDE,kMACO,KAAKb,SADZ,0BAEII,MAAM,CAACW,IAAP,CAAY,uBAAZ,CAAqC,QAArC,EACAtB,MAAM,CAAC,CACLuB,OAAO,CAAE,kBADJ,CAELC,WAAW,CAAE,mCAFR,CAAD,CAAN,CAHJ,yCASE,uBAAKjB,SAAL,4DAAgBkB,EAAhB,CAAmB,SAAnB,CAA8B,KAAKtB,cAAnC,EACA,uBAAKI,SAAL,4DAAgBkB,EAAhB,CAAmB,YAAnB,CAAiC,KAAKnB,iBAAtC,EAVF,mDAWS,KAAKC,SAXd,2CAWS,iBAAgBE,OAAhB,EAXT,+DAvDF,4LAqEE,wIACE,GAAI,KAAKF,SAAT,CAAoB,CAClB,KAAKA,SAAL,CAAemB,UAAf,GACD,CAHH,6DArEF,oIACU3B,YADV","sourcesContent":["import EventEmitter from 'eventemitter3';\nimport { PublicKey, Transaction } from '@solana/web3.js';\nimport { notify } from '../../utils/notifications';\nimport { DEFAULT_PUBLIC_KEY, WalletAdapter } from '../types';\n\ntype SolflareExtensionEvent = 'disconnect' | 'connect';\ntype SolflareExtensionRequestMethod =\n  | 'connect'\n  | 'disconnect'\n  | 'signTransaction'\n  | 'signAllTransactions';\n\ninterface SolflareExtensionProvider {\n  publicKey?: PublicKey;\n  isConnected?: boolean;\n  autoApprove?: boolean;\n  signTransaction: (transaction: Transaction) => Promise<Transaction>;\n  signAllTransactions: (transactions: Transaction[]) => Promise<Transaction[]>;\n  connect: () => Promise<void>;\n  disconnect: () => Promise<void>;\n  on: (event: SolflareExtensionEvent, handler: (args: any) => void) => void;\n  off: (event: SolflareExtensionEvent, handler: (args: any) => void) => void;\n  request: (method: SolflareExtensionRequestMethod, params: any) => Promise<any>;\n}\n\nexport class SolflareExtensionWalletAdapter\n  extends EventEmitter\n  implements WalletAdapter {\n  constructor() {\n    super();\n    this.connect = this.connect.bind(this);\n  }\n\n  private get _provider(): SolflareExtensionProvider | undefined {\n    if ((window as any)?.solflare?.isSolflare) {\n      return (window as any).solflare;\n    }\n    return undefined;\n  }\n\n  private _handleConnect = (...args) => {\n    this.emit('connect', ...args);\n  }\n\n  private _handleDisconnect = (...args) => {\n    this._provider?.off('connect', this._handleConnect);\n    this._provider?.off('disconnect', this._handleDisconnect);\n    this.emit('disconnect', ...args);\n  }\n\n  get connected() {\n    return this._provider?.isConnected || false;\n  }\n\n  get autoApprove() {\n    return this._provider?.autoApprove || false;\n  }\n\n  async signAllTransactions(\n    transactions: Transaction[],\n  ): Promise<Transaction[]> {\n    if (!this._provider) {\n      return transactions;\n    }\n\n    return this._provider.signAllTransactions(transactions);\n  }\n\n  get publicKey() {\n    return this._provider?.publicKey || DEFAULT_PUBLIC_KEY;\n  }\n\n  async signTransaction(transaction: Transaction) {\n    if (!this._provider) {\n      return transaction;\n    }\n\n    return this._provider.signTransaction(transaction);\n  }\n\n  async connect() {\n    if (!this._provider) {\n      window.open('https://solflare.com/', '_blank');\n      notify({\n        message: 'Connection Error',\n        description: 'Please install Solflare extension',\n      });\n      return;\n    }\n    this._provider?.on('connect', this._handleConnect);\n    this._provider?.on('disconnect', this._handleDisconnect);\n    return this._provider?.connect();\n  }\n\n  async disconnect() {\n    if (this._provider) {\n      this._provider.disconnect();\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}