{"ast":null,"code":"import _regeneratorRuntime from\"/Users/cesarhugo.barzano/Desktop/CesarCorp/coins/fork/serum-dex-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/cesarhugo.barzano/Desktop/CesarCorp/coins/fork/serum-dex-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/cesarhugo.barzano/Desktop/CesarCorp/coins/fork/serum-dex-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/cesarhugo.barzano/Desktop/CesarCorp/coins/fork/serum-dex-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/cesarhugo.barzano/Desktop/CesarCorp/coins/fork/serum-dex-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/cesarhugo.barzano/Desktop/CesarCorp/coins/fork/serum-dex-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject;import React,{useState}from'react';import DataTable from'../layout/DataTable';import styled from'styled-components';import{Button,Col,Row,Tag}from'antd';import{cancelOrder}from'../../utils/send';import{useWallet}from'../../utils/wallet';import{useSendConnection}from'../../utils/connection';import{notify}from'../../utils/notifications';import{DeleteOutlined}from'@ant-design/icons';import{jsx as _jsx}from\"react/jsx-runtime\";var CancelButton=styled(Button)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  color: #f23b69;\\n  border: 1px solid #f23b69;\\n\"])));export default function OpenOrderTable(_ref){var openOrders=_ref.openOrders,onCancelSuccess=_ref.onCancelSuccess,pageSize=_ref.pageSize,loading=_ref.loading,marketFilter=_ref.marketFilter;var _useWallet=useWallet(),wallet=_useWallet.wallet;var connection=useSendConnection();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),cancelId=_useState2[0],setCancelId=_useState2[1];function cancel(_x){return _cancel.apply(this,arguments);}function _cancel(){_cancel=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(order){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setCancelId(order===null||order===void 0?void 0:order.orderId);_context.prev=1;if(wallet){_context.next=4;break;}return _context.abrupt(\"return\",null);case 4:_context.next=6;return cancelOrder({order:order,market:order.market,connection:connection,wallet:wallet});case 6:_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);notify({message:'Error cancelling order',description:_context.t0.message,type:'error'});return _context.abrupt(\"return\");case 12:_context.prev=12;setCancelId(null);return _context.finish(12);case 15:onCancelSuccess&&onCancelSuccess();case 16:case\"end\":return _context.stop();}}},_callee,null,[[1,8,12,15]]);}));return _cancel.apply(this,arguments);}var marketFilters=_toConsumableArray(new Set((openOrders||[]).map(function(orderInfos){return orderInfos.marketName;}))).map(function(marketName){return{text:marketName,value:marketName};});var columns=[{title:'Market',dataIndex:'marketName',key:'marketName',filters:marketFilter?marketFilters:undefined,onFilter:function onFilter(value,record){return record.marketName.indexOf(value)===0;}},{title:'Side',dataIndex:'side',key:'side',render:function render(side){return/*#__PURE__*/_jsx(Tag,{color:side==='buy'?'#41C77A':'#F23B69',style:{fontWeight:700},children:side.charAt(0).toUpperCase()+side.slice(1)});},sorter:function sorter(a,b){if(a.side===b.side){return 0;}else if(a.side==='buy'){return 1;}else{return-1;}},showSorterTooltip:false},{title:'Size',dataIndex:'size',key:'size',sorter:function sorter(a,b){return b.size-a.size;},showSorterTooltip:false},{title:'Price',dataIndex:'price',key:'price',sorter:function sorter(a,b){return b.price-a.price;},showSorterTooltip:false},{key:'orderId',render:function render(order){return/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'right'},children:/*#__PURE__*/_jsx(CancelButton,{icon:/*#__PURE__*/_jsx(DeleteOutlined,{}),onClick:function onClick(){return cancel(order);},loading:cancelId+''===(order===null||order===void 0?void 0:order.orderId)+'',children:\"Cancel\"})});}}];var dataSource=(openOrders||[]).map(function(order){return _objectSpread(_objectSpread({},order),{},{key:order.orderId});});return/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{span:24,children:/*#__PURE__*/_jsx(DataTable,{emptyLabel:\"No open orders\",dataSource:dataSource,columns:columns,pagination:true,pageSize:pageSize?pageSize:5,loading:loading!==undefined&&loading})})});}","map":{"version":3,"sources":["/Users/cesarhugo.barzano/Desktop/CesarCorp/coins/fork/serum-dex-ui/src/components/UserInfoTable/OpenOrderTable.tsx"],"names":["React","useState","DataTable","styled","Button","Col","Row","Tag","cancelOrder","useWallet","useSendConnection","notify","DeleteOutlined","CancelButton","OpenOrderTable","openOrders","onCancelSuccess","pageSize","loading","marketFilter","wallet","connection","cancelId","setCancelId","cancel","order","orderId","market","message","description","type","marketFilters","Set","map","orderInfos","marketName","text","value","columns","title","dataIndex","key","filters","undefined","onFilter","record","indexOf","render","side","fontWeight","charAt","toUpperCase","slice","sorter","a","b","showSorterTooltip","size","price","textAlign","dataSource"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport DataTable from '../layout/DataTable';\n\nimport styled from 'styled-components';\nimport { Button, Col, Row, Tag } from 'antd';\nimport { cancelOrder } from '../../utils/send';\nimport { useWallet } from '../../utils/wallet';\nimport { useSendConnection } from '../../utils/connection';\nimport { notify } from '../../utils/notifications';\nimport { DeleteOutlined } from '@ant-design/icons';\nimport { OrderWithMarketAndMarketName } from '../../utils/types';\n\nconst CancelButton = styled(Button)`\n  color: #f23b69;\n  border: 1px solid #f23b69;\n`;\n\nexport default function OpenOrderTable({\n  openOrders,\n  onCancelSuccess,\n  pageSize,\n  loading,\n  marketFilter,\n}: {\n  openOrders: OrderWithMarketAndMarketName[] | null | undefined;\n  onCancelSuccess?: () => void;\n  pageSize?: number;\n  loading?: boolean;\n  marketFilter?: boolean;\n}) {\n  let { wallet } = useWallet();\n  let connection = useSendConnection();\n\n  const [cancelId, setCancelId] = useState(null);\n\n  async function cancel(order) {\n    setCancelId(order?.orderId);\n    try {\n      if (!wallet) {\n        return null;\n      }\n\n      await cancelOrder({\n        order,\n        market: order.market,\n        connection,\n        wallet,\n      });\n    } catch (e) {\n      notify({\n        message: 'Error cancelling order',\n        description: e.message,\n        type: 'error',\n      });\n      return;\n    } finally {\n      setCancelId(null);\n    }\n    onCancelSuccess && onCancelSuccess();\n  }\n\n  const marketFilters = [\n    ...new Set((openOrders || []).map((orderInfos) => orderInfos.marketName)),\n  ].map((marketName) => {\n    return { text: marketName, value: marketName };\n  });\n\n  const columns = [\n    {\n      title: 'Market',\n      dataIndex: 'marketName',\n      key: 'marketName',\n      filters: marketFilter ? marketFilters : undefined,\n      onFilter: (value, record) => record.marketName.indexOf(value) === 0,\n    },\n    {\n      title: 'Side',\n      dataIndex: 'side',\n      key: 'side',\n      render: (side) => (\n        <Tag\n          color={side === 'buy' ? '#41C77A' : '#F23B69'}\n          style={{ fontWeight: 700 }}\n        >\n          {side.charAt(0).toUpperCase() + side.slice(1)}\n        </Tag>\n      ),\n      sorter: (a, b) => {\n        if (a.side === b.side) {\n          return 0;\n        } else if (a.side === 'buy') {\n          return 1;\n        } else {\n          return -1;\n        }\n      },\n      showSorterTooltip: false,\n    },\n    {\n      title: 'Size',\n      dataIndex: 'size',\n      key: 'size',\n      sorter: (a, b) => b.size - a.size,\n      showSorterTooltip: false,\n    },\n    {\n      title: 'Price',\n      dataIndex: 'price',\n      key: 'price',\n      sorter: (a, b) => b.price - a.price,\n      showSorterTooltip: false,\n    },\n    {\n      key: 'orderId',\n      render: (order) => (\n        <div style={{ textAlign: 'right' }}>\n          <CancelButton\n            icon={<DeleteOutlined />}\n            onClick={() => cancel(order)}\n            loading={cancelId + '' === order?.orderId + ''}\n          >\n            Cancel\n          </CancelButton>\n        </div>\n      ),\n    },\n  ];\n  const dataSource = (openOrders || []).map((order) => ({\n    ...order,\n    key: order.orderId,\n  }));\n\n  return (\n    <Row>\n      <Col span={24}>\n        <DataTable\n          emptyLabel=\"No open orders\"\n          dataSource={dataSource}\n          columns={columns}\n          pagination={true}\n          pageSize={pageSize ? pageSize : 5}\n          loading={loading !== undefined && loading}\n        />\n      </Col>\n    </Row>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}